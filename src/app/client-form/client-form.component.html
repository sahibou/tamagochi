<div class="flex-client-form">
    <div class="left">
        <form [formGroup]="clientForm" (submit)="submitClientForm($event)"> 

            <mat-form-field class="input-client">
                <mat-label>Votre prénom</mat-label>
                <input matInput type="text" formControlName="firstName" placeholder="Exemple: Anakin"/>
            </mat-form-field>
            <mat-form-field class="input-client">
                <mat-label>Votre nom</mat-label>
                <input  matInput type="text" formControlName="lastName" placeholder="Exemple: Skywalker"/>
            </mat-form-field>
            <mat-form-field class="input-client">
                <mat-label>Votre adresse</mat-label>
                <input matInput type="text" formControlName="address" (change)="updateAdresseSaisie()" placeholder="Exemple: 3 Rue de l\'Abbé Rozier, 69001 Lyon"/>
            </mat-form-field>

            
            @if(this.chargementAdresses!==''){
                <label for="address2">{{this.chargementAdresses}}</label> 
                <mat-progress-bar class="progress-addr" mode="buffer"></mat-progress-bar>
            }
            @if(!this.chargementAdresses){
                <p>Adresses compatibles trouvés : {{this.matchingAdresses.length}}</p>  
            }
            <mat-form-field class="input-client">
                <mat-label>Adresses compatibles</mat-label>
                <mat-select (selectionChange)="newLocationSelected($event)" formGroupName="address2">
                    @for(ad of matchingAdresses; track ad.fulltext){
                        <mat-option value="{{ad.fulltext}}">{{ad.fulltext}}</mat-option>
                    }    
                </mat-select>
            </mat-form-field> 

            
            
            @if(this.selectedAddress){
                <app-leaflet-map [selectedAddress]="selectedAddress" (parcelleEvent)="newParcelInfo($event)"></app-leaflet-map>
            }
            <a mat-flat-button routerLink="">Retour</a>
            <button mat-flat-button type="submit" class="primary">Soumettre</button>
            
        </form>

    
        @if(firstName?.invalid){
            <div class="alert alert-danger">le prénom n'est pas saisi</div>
        }
        @if(lastName?.invalid){
            <div class="alert alert-danger">le nom n'est pas saisi</div>
        }
        @if(address?.invalid){
            <div class="alert alert-danger">l'adresse n'est pas saisie</div>
        }
    
    </div>


    <div class="right">
        @if(this._parcelInfoReceived){
            <p>{{this._parcelInfoReceived.id}}</p>
            @if(this._parcelInfoReceivedProps){
                <p>code_arr : {{this._parcelInfoReceivedProps['code_arr']??''}}</p>
                <p>code_com : {{this._parcelInfoReceivedProps['code_com']??''}}</p>
                <p>code_dep : {{this._parcelInfoReceivedProps['code_dep']??''}}</p>
                <p>code_insee : {{this._parcelInfoReceivedProps['code_insee']??''}}</p>
                <p>com_abs : {{this._parcelInfoReceivedProps['com_abs']??''}}</p>
                <p>contenance : {{this._parcelInfoReceivedProps['contenance']??''}}</p>
                <p>feuille : {{this._parcelInfoReceivedProps['feuille']??''}}</p>
                <p>gid : {{this._parcelInfoReceivedProps['gid']??''}}</p>
                <p>idu : {{this._parcelInfoReceivedProps['idu']??''}}</p>
                <p>nom_com : {{this._parcelInfoReceivedProps['nom_com']??''}}</p>
                <p>numero : {{this._parcelInfoReceivedProps['numero']??''}}</p>
                <p>section : {{this._parcelInfoReceivedProps['section']??''}}</p>
            }

        }
    </div>
</div>